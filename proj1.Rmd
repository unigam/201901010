---
title: "RP_Doc_NIGAM"
author: "Uddeshya NIGAM"
date: "10/11/2019"
output: 
    rmdformats::readthedown
code_folding : hide
---
*** 

# **1. Research Question and Background** 

With the recent surge in the number of mass shootings and other serious criminal activities in different establishments and institutions across the United States, it has become a concern for policymakers and law enforcement officials alike, to take steps in order to curb crimes. Across the USA, from 2010 until 2018, the K12 mass shootings increased from 15 to 110 as can be seen below. (data by CHDS)

<center><img src="https://github.com/unigam/201901010/blob/master/incidents_by_year.png?raw=true"></center>

These crimes have serious implications on the safety of students and staff at schools where these factors might affect the quality of learning and overall educational attainment. 

The primary purpose of this paper is to examine as to what extent do factors other than security measures undertaken by the school and law enforcement affect crimes of varying degrees in schools. Previous work done by researchers (Jennings et al.2011), have examined relationships between school security facilities and crimes; concluding that increase in deployment of recognizable law enforcement officials and metal detectors reduced violent crimes while increased possession of firearms by police was statistically associated with higher violent criminal activities. This paper would expand on such research by examining if certain school characteristics like race (percentage of whites and non-white people enrolled), the level of education (primary, high school, middle school or combined), school size with respect to total enrollment, location of the school (whether in a city, suburban area, town or a rural area) affect the number of crimes both violent (indicated by actions such as shootings, attacks, murders, etc.) and non-violent (possession of weapons, drugs, etc.). 

This study can hence be viewed as a humbly attempted extension of the previous work done by economists and researchers on addressing K12 crime issues, while helping legislators and law enforcements alike to take steps to address them hence ensuring a safe environment for learning and growth for students all over the US.

***

# **2. Dataset and Data description** 
 
The dataset comes from the SSOC 2010 survey on the crime statistics in K-12 schools across the USA. The survey was conducted using a questionnaire mailed to schools (primary, secondary, high, combined) and telephone follow-ups of school principal officials. Missing values have been imputed. The sample has responses from 2648 schools with a larger proportion of middle and high schools based on the idea (according to data by NCS) that most of the crimes have been reported from middle and high schools. 

## 2.1  Variables under study

In order to extract variables of interest for our study, one needs to read through and interpret variable history and descriptions from the adjoining codebook which can be found at https://nces.ed.gov/pubs2015/2015061.pdf

Composite variables have been created as a combination of relevant variables as found in the dataset so as to aid the researcher in carrying analysis without having to create additional data frames as a summation of variables of interest. In order to prevent this section being unnecessarily long, the summaries of our response variables have been provided below (individual code descriptions can be found in the codebook). 

### *2.1.1  Dependent/Response Variables* 

1. VIOINC10 <- Total number of violent incidents recorded by the school. 
These incidents include activities involving a weapon or otherwise like homicides, murder, robbery, threats of attacks, rape. 
VIOINC10 - sum(C0310, C0314, C0318, C0322, C0326, C0330, C0334, C0338)

2. VIOPOL10 <- Total number of violent crime incidents reported to the police or relevant law enforcement. 
From intuition, this number ought to be less than VIOINC08, else we might need to account for incidents which might be reported to police straight away rather than taking recourse to school officials suggesting a higher degree of damage or threat. Let's have a look at the result from the code chunk below :
VIOPOL10 - sum(C0312, C0316, C0320, C0324, C0328, C0332, C0336, C0340)

```{r, message=FALSE, warning=FALSE}
#load dataset from Github; raw link
library(haven)
dat <- read_sas("https://github.com/unigam/201901010/blob/master/backup/pu_ssocs10_sas.sas7bdat?raw=true", 
NULL)
#load stargazer for later analysis 
library(stargazer)
#check if sum of VIOPOL08 > sum of VIOINV08
sum(dat$VIOPOL10)>sum(dat$VIOINC10)
```

The statement returns "FALSE" which confirms our intuition is correct.

3. GANGHATE10 <- Total number of hate crimes and gang related crimes 
GANGHATE10 - sum(C0366, C0368, C0369)


### *2.1.2  Independent Variables* 

These variables answer - 'to what extent are the dependent variables in our study depend on these independent variables'

1. PERCWHT = This is a SSOCS-created variable representing Percent White enrollment as reported in the 2007–08 CCD school data file. This variable has four categories. 1 = more than 95 percent, 2 = more than 80 to 95 percent, 3 = more than 50 to 80 percent, and 4 = 50 percent or less. (Categorical)

2. FR_LVEL = School grades offered as reported in the 2005–06 CCD school data file. This variable has four categories indicating the span of grades offered. 1=primary, 2=middle, 3=high school, and 4=combined. (Categorical) 

3. FR_SIZE = Size categories. This variable collapses the number of students into four categories: 1=less than 300; 2=300–499; 3=500–999; and 4=1,000 or more. (Categorical) 

4. FR_URBAN = This variable collapses the 12-level locale variable on the SSOCS:2008 restricted-use file into four categories: city (FR_LOC12/R=11, 12, or 13), suburb (FR_LOC12/R=21, 22, or 23), town (FR_LOC12/R=31, 32, or 33), and rural (FR_LOC12/R=41, 42, or 43). (Categorical) 

### *2.1.2.1  We can summarise the various independent variables as below to see their distribution across categories*

1. Number of schools by percentage of white students enrolled

```{r}
#barplot showing number of schools by % of white enrollment 
counts <- table(dat$PERCWHT)
barplot(counts, main="Schools by % White Enrollment",
  names.arg=c(">95%", ">80% till 95%", ">50% till 80%","50% or less"))
```
2. Number of schools by grade levels

```{r}
#barplot showing number of schools by grade levels offered 
counts <- table(dat$FR_LVEL)
barplot(counts, main="Schools by Grade Levels",
  names.arg=c("Primary", "Middle", "High School","Combined"))
```

3. Number of schools by enrollment size

```{r}
#barplot showing number of schools by enrollment size
counts <- table(dat$FR_SIZE)
barplot(counts, main="Schools by Enrollment Size",
  names.arg=c("less than 300", "300-499", "500-999","1000 or more"))
```

4. Number of schools by location

```{r}
#barplot showing number of schools by location
counts <- table(dat$FR_URBAN)
barplot(counts, main="Schools by Location",
  names.arg=c("City", "Suburban", "Town","Rural"))
```

***
# **3.  Empirical Model **
The dependent variables considered in this draft are discreet in nature. However the independent variables are both discreet and ordinal categorical variables. 
One can employ simple linear and/or multiple linear regressions. Pearson's correlation might not give meaningful results for descriptive statistics owing to categorical variables so one could employ one-way ANOVA to study if mean values are equal for a dependent variable across different categories of our independent categorical variable.
Let's consider if the number of hate/gang related crimes have equal mean values across different levels of percentage of white people enrolled (cat. 1-4 as described in section 2.1.2 ) 
```{r}
#convert PERCWHT to factor(perwht)
perwht <- factor(dat$PERCWHT, ordered = FALSE)
#carry out one-way ANOVA between total number of hate crimes and gang related crimes and categories of perwht
summary(aov(dat$GANGHATE~perwht)) 
```

Let's see what we have for the other independent variables with respect to GANGHATE. 
1. ANOVA test of school level of education against total number of gang related crimes
```{r}
#convert FR_LVEL to factor(fr_lvel)
fr_lvel <- factor(dat$FR_LVEL, ordered = FALSE)
#carry out one-way ANOVA between total number of hate crimes and gang related crimes and categories of fr_lvel
summary(aov(dat$GANGHATE~fr_lvel)) 
```
2. ANOVA test of school enrollment size against total number of gang related crimes
```{r}
#convert FR_SIZE to factor(fr_size)
fr_size <- factor(dat$FR_SIZE, ordered = FALSE)
#carry out one-way ANOVA between total number of hate crimes and gang related crimes and categories of fr_size
summary(aov(dat$GANGHATE~fr_size)) 
```
3. ANOVA test of school location against total number of gang related crimes
```{r}
#convert FR_URBAN to factor(fr_urban)
fr_urban <- factor(dat$FR_URBAN, ordered = FALSE)
#carry out one-way ANOVA between total number of hate crimes and gang related crimes and categories of fr_urban
summary(aov(dat$GANGHATE~fr_urban)) 
```
It's evident that our results are statistically significant (p<0.05) hence they will be all incoporated in our regression analysis!  
***

# **4.  Analysis and Results **
A multiple regression between GANGHATE, VIOINC10, VIOPOL10 and factors of PERCWHT, FR_LVEL, FR_SIZE, FR_URBAN to check the partial effects of each on the dependent variables.
```{r, results = "asis"}
#Results of the regression
m1<- lm(formula = GANGHATE~perwht+fr_lvel+fr_size+fr_urban, data = dat)
m2<- lm(formula = VIOINC10~perwht+fr_lvel+fr_size+fr_urban, data = dat)
m3<- lm(formula = VIOPOL10~perwht+fr_lvel+fr_size+fr_urban, data = dat)
stargazer(list(m1, m2, m3), type="html", single.row = TRUE,
    covariate.labels = c("greater than 80% till 95% white enrollment","greater than 50% till 80% white enrollment","50% or less white enrollment","Middle Schools","High Schools","Combined Grade Offering","300-499 enrollment size","500-999 enrollment size","1000 or more enrollment size","Suburban Schools","Schools in Towns", "Schools in Rural Regions"),
    dep.var.labels = c("Total number of hate and gang related crimes reported", "Total number of violent crimes reported by the school","Total number of violent crimes reported by the police"),
          column.labels = c("Model 1", "Model 2","Model 3"))
```

The results can be interpreted as follows : (ceterus paribus)

1. The total number of gang hate crimes on average for schools with white student enrollment >80%-95% is 0.298 instances lesser than schools with white student enrollment of >95%. Also, the total number of gang hate crimes on average for schools with white student enrollment >50%-80% and >50% is 0.069 instances lesser and 1.226 instances more than schools with white student enrollment of >95% respectively. 
This observation faces issues of statistical significance for the first two categories of the variable "percentage of white student enrollment", hence in order to confirm if this variable should be dropped from our model, we conduct a Likelihood Ratio Test and see if p<0.05 for our level of significance. There might be a multicollinearity issue too here (schools with >95% whites will also encompass schools with >80%-95% whites)

```{r}
#LRT test 
mhat_perwht<-lm(formula = GANGHATE~fr_lvel+fr_size+fr_urban, data = dat)
anova(m1, mhat_perwht, test="LRT")
```

Since p<0.05, the variable should be inluded in the model. 

2. The total number of gang hate related crimes on average for middle schools is 0.893 instances greater than those in primary schools, while it is 0.909 and 0.81 instances greater for high schools and schools with combined grade offerings. Fair to assume that since combined grade offerings also include primary schools, the coefficient is lesser than that of middle and high schools. The observation for combined grade offerings renders a p-value of 0.18102; this could be attributed to some multicollinearity since the difference across levels in this category is being compared against primary schools but the combined grade offerings level itself contains some students from primary schools. 

3. For our next variable, we observe that schools with enrollment size of 300-499 report gang related crimes on an average of 0.201 instances greater than schools with size of less than 300 students. This number increases to 0.436 for schools of size 500-999 students and 1.239 for schools with 1000 or more than 1000 students. 
Results might come across as statistically insignificant owing to multicollinearity issues. Schools with size 500-999 might not be considered as schools with more than 1000 students but could potentially be considered as encompassing schools with 300-499 students!

4. Our last variable in the model can be explained as follows : Schools in suburban areas report on an average 1.323 lesser instances of gang related crimes as compared to schools in cities while schools in towns and rural areas report 1.221 and 1.309 instances of lesser gang and hate related crimes on an average than schools in cities. All results are significant with p<0.05

##  4.1  Improved Model with changed reference levels

Let's change the factor levels to account for multicollinearity issues by relevelling and see how our results stack up both in terms of beta coefficients and significance tests!

```{r, results = "asis"}
perwht <- relevel(perwht, ref = 4)
fr_lvel <- relevel(fr_lvel, ref = 1)
fr_size <- relevel(fr_size, ref = 4)
fr_urban <- relevel(fr_urban, ref = 1)
m1<- lm(formula = GANGHATE~perwht+fr_lvel+fr_size+fr_urban, data = dat)
m2<- lm(formula = VIOINC10~perwht+fr_lvel+fr_size+fr_urban, data = dat)
m3<- lm(formula = VIOPOL10~perwht+fr_lvel+fr_size+fr_urban, data = dat)
stargazer(list(m1, m2, m3), type="html", single.row = TRUE,
covariate.labels = c("greater than 95% white enrollment","greater than 80% till 95% white enrollment","greater than 50% till 80% white enrollment","Middle Schools","High Schools","Combined Grade Offering","less than 300 enrollment size","300-499 enrollment size","500-999 enrollment size","Suburban schools","Schools in Towns", "Schools in Rural Regions"),
    dep.var.labels = c("Total number of hate and gang related crimes reported", "Total number of violent crimes reported by the school","Total number of violent crimes reported by the police"),
          column.labels = c("Model 1", "Model 2","Model 3"))
```

It's but obvious that relevelling will change our interpretation since the reference point within the categorical variable changes. 

1. We now see that schools with more than 95% white student enrollment report gang-hate related crimes 1.226 instances lesser on average when compared to schools with less than 50% white student enrollment while these numbers are 1.524 and 1.294 on average (lesser than our reference point: <50% white enrollment) for schools with >80%-95% and >50%-80% white student enrollment respectively.
The results are now significant at 0.05 level.
The results are interesting since they tell us that on either extremes (too many whites or too few whites) might report more of such crimes. The least vulnerable school to such instances in our sample seems to be the school category with >80%-95% white student enrollment. However the racial biased against non-whites committing more of these crimes is confirmed with our sample as can be seen in the signs of beta coefficients obtained.

2. The total number of gang hate related crimes on average for middle schools is 0.893 instances greater than those in primary schools, while it is 0.909 and 0.81 instances greater for high schools and schools with combined grade offerings. The multicollinearity in terms of combined grade offerings as explained above cannot really be corrected as the sample has been designed that way. 
The notion is confirmed that high and middle schools are at an increased risk of such crimes as compared to primary schools.

3. For our next variable, we observe that schools with enrollment size of less than 300 report gang related crimes on an average of 1.239 instances lesser than schools with size of 1000 or more students. Schools with 300-499 and 500-999 students report such crimes on an average 1.038 and 0.803 lesser respectively than schools of 1000 students or more.
It's clear that schools with greater size are at increasing risk of reporting more of such crimes.

4. The results of the last variable are the same as obtained in the previous regression showing that schools in cities are at an increased risk for gang and hate related crimes. 

Notice how relevelling for Model 1 also comparatively improves signifiance test results for Model 2 and 3 respectively. For our second model, we examine how the total number of violent incidents reported (which include activities involving a weapon or otherwise like homicides, murder, robbery, threats of attacks, rape) are affected by school levels, size, % white students and location. 
The trend for our first independent variable (% whites) signifies that schools with >95% white population report 12.869 lesser instances of crimes on an average as compared to schools with less than 50% white population. Schools with >80%-95% white enrollment fare better (lesser crimes reported) as compared to schools with >50%-80% and >95%  white enrollment. Interestingly, here the middle schools fared worst (most instances of crime reported in comparion to primary schools) when compared to high schools and combined grade offerings. The trend is similar as in model 1 with respect to school size (greater the size, higher the number of crimes reported by the school) while location yields results which fails the 0.05 level significance test, indicating that we fail to reject the null hypothesis about varying degrees of violent crimes reported by school across levels of school location. 
Model 3 witnesses similar trend observations as our second model when % white enrollment is considered. However, in terms of school levels, high schools tended to have highest instances of violent crimes reported by the police on average when compared to primary schools, similar to results obtained in our first model. For the variable school enrollment size, it also shows that bigger schools tend to be at a higher risk for violent crimes. The location coefficients are not significant at 0.05 level of testing, similar to model 2. 

What does all of this discussion imply? Firstly, it confirms the racial bias against non-white people, who are accused of comitting more crimes. It also shows that schools with an extremely high number of whites (>95%) might also report higher instances of crimes as compared to schools with other compositions (except <50% whites). This might be attributed to imbalances in diversity in the school environment which lead to crimes against non-whites as the latter is a minority in such schools. Hence diversity imbalances on both extremes are bad for ensuring overall safety. Secondly, it confirms research on data of previous years that middle and high schools tend to report higher instances of crime as compared to primary schools. Hence they might need increased attention and preventive measures. Thirdly, schools with more students tend to be at a higher risk of either gang related or violent crimes. This could be expected as a higher enrollment size increases the risk exposure to crimes. And lastly, schools in cities report higher instances of gang and hate related crimes as compared to schools in the suburbs, towns or rural regions but the risk in towns is still higher than in suburbs or rural zones possibly because of bigger town sizes resembling almost the size of an average city incorporated in our sample. This defies any previous assumption that better educational and/or awareness facilities in cities would witness lesser instances of hate and gang related crimes! 

##  4.2   Additional Tests of Significance (F-test)

Let us examine the failure of variable fr_urban (location of schools) in our Models 2 and 3 at 0.05 level
We conduct an F-test to see if we can drop fr_urban, checking the p value if it is <0.05
```{r}
m2hatt<- lm(formula = VIOINC10~perwht+fr_lvel+fr_size, data = dat)
anova(m2,m2hatt)

m3hatt<- lm(formula = VIOPOL10~perwht+fr_lvel+fr_size, data = dat)
anova(m3,m3hatt)
```

Clearly we obtain p>0.05 wherein we fail to reject the hypothesis that fr_urban as a predictor for Models 2 and 3 is not significant at 0.05 level. One could hence drop that variable from Model 2 and Model 3. 

##  4.3   Short Comings and Limitations of the study

One obvious short-coming in our regression analysis was using the level = combined offerings in terms of school levels which incorporates all school levels, making multicollinearity issues arise. Besides that, the regression models run had independent variables which were not incorporated in previous papers with the SSOC 2010 Survey Data. By no means is the model complete, as is reflected in R square values which state only 4.7%, 10.7% and 9.7% of the variations in our dependent variables across Models 1,2,3 respectively were explained by our independent variables of interest. Hence a lot of improvement can be made to increase the explanatory power of our regression models.

# **5. Bibliography **

1.  Jennings, W. G., D. N. Kyehb, J. Maskalya, and C. M. Donnera (2011). “Evaluating the Relationship Between
Law Enforcement and School Security Measures and Violent Crime in Schools.” Journal of Police Crisis
Negotiations 11(2): 109–124.

2.  Neiman, S. (2011). Crime, Violence, Discipline, and Safety in U.S. Public Schools: Findings From the School Survey on Crime and Safety: 2009–10 (NCES 2011-320). National Center for Education Statistics, Institute of Education Sciences, U.S. Department of Education. Washington, DC.

3.  Nickerson, A. B., and E. D. Slater (2009). “School and Community Violence and Victimization as Predictors
of Adolescent Suicidal Behavior.” School Psychology Review 38(2): 218

4.  Van Horn, R. (1998). “Keeping Children Safe.” Phi Delta Kappan 79(8): 633–634.
